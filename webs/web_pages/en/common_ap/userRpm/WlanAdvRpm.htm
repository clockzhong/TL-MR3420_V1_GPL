
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<SCRIPT language="JavaScript" src="../dynaform/custom.js" type="text/JavaScript"></SCRIPT>
<SCRIPT type="text/javascript"><!-- 
var g_txPower	 = wlanAdv[0];
var g_bcPrd		 = wlanAdv[1];
var g_rtsThd	 = wlanAdv[2];
var g_fragThd	 = wlanAdv[3];
var g_dtimThd	 = wlanAdv[4];
var g_wmm		 = wlanAdv[5];
var g_shotGI	 = wlanAdv[6];
var g_apisolation= wlanAdv[7];

function doSubmit()
{
	var df = document.forms[0];
	
	var ct_vapIdx = df.vapIdx;
	if (!ct_vapIdx || ct_vapIdx.value < 1 || ct_vapIdx.value > 3)
	{
		alert(js_pl_sel_power="Please select the correct SSID index !");
		ct_vapIdx.focus();
		ct_vapIdx.select();
		return false;
	}
	
	var ct_beaconPeriod = df.beaconPeriod;
    if(is_digit(ct_beaconPeriod.value) == false)
    {
		ct_beaconPeriod.focus();
		ct_beaconPeriod.select();
		return false;
    }
	if (!ct_beaconPeriod || ct_beaconPeriod.value < 20 || ct_beaconPeriod.value > 1000)
	{
		alert(js_beacon="The value of Beacon Interval must between 20 and 1000, please input a correct one !");
		ct_beaconPeriod.focus();
		ct_beaconPeriod.select();
		return false;
	}

	var ct_rtsThreshold = df.rtsThreshold;
    if(is_digit(ct_rtsThreshold.value) == false)
    {
		ct_rtsThreshold.focus();
		ct_rtsThreshold.select();
		return false;
    }
	if (!ct_rtsThreshold || ct_rtsThreshold.value < 1 || ct_rtsThreshold.value > 2346)
	{
		alert(js_rts="The value of RTS Threshold must between 1 and 2346, please input a correct one !");
		ct_rtsThreshold.focus();
		ct_rtsThreshold.select();
		return false;
	}

	var ct_fragThreshold = df.fragThreshold;
    if(is_digit(ct_fragThreshold.value) == false)
    {
		ct_fragThreshold.focus();
		ct_fragThreshold.select();
		return false;
    }
	if (!ct_fragThreshold || ct_fragThreshold.value < 256 || ct_fragThreshold.value > 2346)
	{
		alert(js_frag="The value of Fragmentation Threshold must between 256 and 2346, please input a correct one !");
		ct_fragThreshold.focus();
		ct_fragThreshold.select();
		return false;
	}

	var ct_dtimInterval = df.dtimInterval;
    if(is_digit(ct_dtimInterval.value) == false)
    {
		ct_dtimInterval.focus();
		ct_dtimInterval.select();
		return false;
    }
	if (!ct_dtimInterval || ct_dtimInterval.value < 1 || ct_dtimInterval.value > 255)
	{
		alert(js_dtim="The value of DTIM Interval must between 1 and 255, please input a correct one !");
		ct_dtimInterval.focus();
		ct_dtimInterval.select();
		return false;
	}

	return true;
}
function onChangeMbssid()
{
	location.href="/userRpm/WlanAdvRpm.htm?vapIdx="+document.forms[0].vapIdx.value;
}
//--></SCRIPT>
</HEAD>
<BODY onLoad="setTagStr(document,'ntw_wlan_adv');LoadHelp('WlanAdvHelpRpm.htm'); resize(this);" onResize="resize(this);">
<CENTER>
  <FORM action="WlanAdvRpm.htm" enctype="multipart/form-data" method="get" onSubmit="return doSubmit();">
    <TABLE id="autoWidth"  width="562" border="0" cellspacing="0" cellpadding="0">
      <TR>
        <TD colspan=2 class=h1 id="t_title">Wireless Advanced</TD>
      </TR>
      <TR>
        <TD class=blue colspan=2></TD>
      </TR>
			<TR id="line_OperMode">
				<TD class="Item" id="t_transmit_power">Operation Mode:</TD>
				<TD class=emp><span id="t_operMode">
					<SCRIPT type="text/javascript">
						var operModeIdx = getOperModeIdxByValue(operMode);
						if(operModeIdx != null)
						{
							document.write(getOperModeName(operModeIdx));
						}
					</SCRIPT>
					</span>&nbsp;&nbsp;
					<select name="vapIdx" class="listS" id="vapIdx" onChange="onChangeMbssid();">
						<option value="1">SSID1</option>
						<option value="2">SSID2</option>
						<option value="3">SSID3</option>
						<option value="4">SSID4</option>
					</select>
				</TD>
			</TR>
      <TR>
        <TD colspan=2 class=blue>&nbsp;</TD>
      </TR>
			<TR style="display">
				<TD class="Item" id="t_transmit_power">TX power</TD>

				<TD>
					<select name="txPower" class="listS" id="txPower">
						<option value="1" id="t_high">high</option>
						<option value="2" id="t_middle">middle</option>
						<option value="3" id="t_low">low</option>
					</select>
				</TD>

			</TR>
      <TR id="line_tag_bcn_prd">
        <TD class="Item" id="t_beacon_interval">Beacon Interval :</TD>
        <TD><INPUT name="beaconPeriod" type="text" class="text" maxlength="4" size="4">
          &nbsp; (20-1000) </TD>
      </TR>
      <TR>
        <TD class="Item" id="t_rts_threshold">RTS Threshold:</TD>
        <TD><INPUT name="rtsThreshold" type="text" class="text" maxlength="4" size="4">
          &nbsp; (1-2346) </TD>
      </TR>
      <TR>
        <TD class="Item" id="t_frag">Fragmentation Threshold:</TD>
        <TD><INPUT name="fragThreshold" type="text" class="text" maxlength="4" size="4">
          &nbsp; (256-2346) </TD>
      </TR>
      <TR id="line_tag_dtm_inter">
        <TD class="Item" id="t_dtim">DTIM Interval:</TD>
        <TD><INPUT name="dtimInterval" type="text" class="text" maxlength="4" size="4">
          &nbsp; (1-255) </TD>
      </TR>
      <TR>
        <TD class="Item">&nbsp;</TD>
        <TD><INPUT name="wmm" type="checkbox" value = "2">
          &nbsp;<SPAN id="t_enable_wmm">Enable WMM</SPAN></TD>
      </TR>
      <TR>
        <TD class="Item">&nbsp;</TD>
        <TD><INPUT name="shortGI" type="checkbox" value = "2">
          &nbsp;<SPAN id="t_enable_short_gi">Enable Short GI</SPAN></TD>
      </TR>
      <SCRIPT type="text/javascript">
//if (wlanAdv[9] == 0)
//{
	document.write('<TR id="line_t_enable_ap"><TD class=Item>&nbsp;</TD><TD><INPUT type=checkbox value=2 name=apisolation>&nbsp;<span id="t_enable_ap">Enable AP Isolation</span></TD></TR>');
//}
</SCRIPT>
<SCRIPT type="text/javascript">
if(wlanAdv[8] == 1)
{
//added by ZQQ.08.12.05
    document.write('<TR><TD colspan=2><span style="color:#FF0000" id="t_chng">The change of wireless config will not take effect until the AP reboots, please </span><A href="../userRpm/SysRebootRpm.htm" id="t_click">click here</A><span id="t_to_reboot" style="color:#FF0000"> to reboot.</span> </TD></TR>');  
}
</SCRIPT>
      <TR>
        <TD colspan=2 class=blue>&nbsp;</TD>
      </TR>
      <TR>
        <TD class="Item">&nbsp;</TD>
        <TD><INPUT name="Save" type="submit" class="buttonBig" id="Save" value="Save"></TD>
      </TR>
    </TABLE>
  </FORM>
</CENTER>
</BODY>
</HTML>
<SCRIPT type="text/javascript">
var df = document.forms[0];
if (g_vapIdx >= 1 && g_vapIdx <= 4)
{
	df.vapIdx.value = g_vapIdx;
}
else if(g_vapIdx == 0)
{
	document.getElementById("vapIdx").style.display="none";
	df.vapIdx.value = 1;
}
if (g_txPower >= 1 && g_txPower <= 3)
{
	df.txPower.value = g_txPower;
}
if (g_bcPrd >= 20 && g_bcPrd <= 1000)
{
	df.beaconPeriod.value = g_bcPrd;
}
else
{
	df.beaconPeriod.value = 100;
}

if (g_rtsThd >= 1 && g_rtsThd <= 2346)
{
	df.rtsThreshold.value = g_rtsThd;
}
else
{
	df.rtsThreshold.value = 2346;
}

if (g_fragThd >= 256 && g_fragThd <= 2346)
{
	df.fragThreshold.value = g_fragThd;
}
else
{
	df.fragThreshold.value = 2346;
}

if (g_dtimThd >= 1 && g_dtimThd <= 255)
{
	df.dtimInterval.value = g_dtimThd;
}
else
{
	df.dtimInterval.value = 1;
}

if (g_wmm == 1)
{
	df.wmm.checked = true;
}
else
{
	df.wmm.checked = false;
}

if (g_shotGI == 1)
{
	df.shortGI.checked = true;
}
else
{
	df.shortGI.checked = false;
}

if (g_apisolation == 1)
{
	df.apisolation.checked = true;
}
else
{
	df.apisolation.checked = false;
}
//if enable bridge,disable apisolation
if(wlanAdv[9] == 1)
{
	df.apisolation.disabled = true;
}
if(operMode == 3 || operMode == 6)
{
	document.getElementById("line_tag_bcn_prd").style.display = "none";
	document.getElementById("line_tag_dtm_inter").style.display = "none";
	document.getElementById("line_t_enable_ap").style.display = "none";
}
if(operMode==7)
	document.getElementById("line_t_enable_ap").style.display = "none";
</SCRIPT>
