
	<META http-equiv=Content-Type content="text/html; charset=gb2312">
	<SCRIPT language="JavaScript">
	<!-- 
		function isStatOn(item)
		{
			return 	(secParam[0] & item);
		}
			
		var FW_SPI					=	0x00000001;
		var VPN_PPTP_PASSTHROUGH	=	0x00000100;
		var VPN_L2TP_PASSTHROUGH	=	0x00000200;
		var VPN_IPSEC_PASSTHROUGH	=	0x00000400;
		var NAT_FTP_ALG				=	0x00010000;
		var NAT_TFTP_ALG			=	0x00020000;
		var NAT_H323_ALG			=	0x00040000;
		var spifw = isStatOn(FW_SPI); 
		var pptp = isStatOn(VPN_PPTP_PASSTHROUGH);
		var l2tp = isStatOn(VPN_L2TP_PASSTHROUGH);
		var ipsec = isStatOn(VPN_IPSEC_PASSTHROUGH);
		var ftp = isStatOn(NAT_FTP_ALG);
		var tftp = isStatOn(NAT_TFTP_ALG);
		var h323 = isStatOn(NAT_H323_ALG);
		
		function doSave()
		{			
			var lp = location.pathname;
			
			var s = document.getElementById("enable_spi").checked;
			var p = document.getElementById("enable_pptp_passthrough").checked;
			var l = document.getElementById("enable_l2tp_passthrough").checked;
			var i = document.getElementById("enable_ipsec_passthrough").checked;
			var f = document.getElementById("enable_ftp_alg").checked;
			var t = document.getElementById("enable_tftp_alg").checked;
			var h = document.getElementById("enable_h323_alg").checked;
			
			var new_stat = s | (p << 8) | (l << 9) | (i << 10) | (f << 16) | (t << 17) | (h << 18);
		
			location.href = lp + "?stat=" + new_stat + "&Save=Save";		
			return true;
		}
		
		function doHelp()
		{
			location.href="/help/BasicSecurityHelpRpm.htm";
		}
	//-->
	</SCRIPT>
</HEAD>

<BODY>
<CENTER>
<center>
<table width="402" border="0" cellspacing="0" cellpadding="0">
<tr>
	<td width="7" class="title"><img src="/images/arc.gif" width="7" height="24"></td>

	<td width="395" align="left" valign="middle" class="title">安全设置</td>
</tr>
<tr><td colspan="2">
	<table width="402" border="0" cellspacing="0" cellpadding="0">
		<tr>
			<td class="vline" rowspan="15"><br></td>
			<td width="400">
				<table width="310" border="0" align="center" cellpadding="0" cellspacing="0" class="space">
					<tr><td>本页对各个基本安全功能的开启与关闭进行设置。</td></tr>

				</table> 
				
				<table border="1" width="340" align="center" cellspacing="0" cellpadding="0" class="space">
					<tr><td width="310">
						<table border="0" width="300" align="center" cellspacing="0" cellpadding="2">
							<tr><td width="300" colspan="2">状态检测防火墙 (SPI)</td></tr>
							<!--<tr><td colspan="2">&nbsp;</td></tr>-->
	<TR>
								<TD width="100">&nbsp;&nbsp;SPI 防火墙：</TD>
								<TD>
									<input name="spi" id="enable_spi" type="radio" value="1">启用&nbsp;&nbsp;
									<input name="spi" id="disable_spi" type="radio" value="0">不启用
								</TD>
	</TR>
						</table>
					</td></tr>
				</table>
				
				<table border="1" width="340" align="center" cellspacing="0" cellpadding="0" class="space">
					<tr><td width="310">
						<table border="0" width="300" align="center" cellspacing="0" cellpadding="2">
							<tr><td width="300" colspan="2">虚拟专用网络 (VPN)</td></tr>
							<!--<tr><td colspan="2">&nbsp;</td></tr>-->
			<TR>
								<TD width="100">&nbsp;&nbsp;PPTP 穿透：</TD>
								<TD>
									<input name="pptp_passthrough" id="enable_pptp_passthrough" type="radio" value="1">启用&nbsp;&nbsp;
									<input name="pptp_passthrough" id="disable_pptp_passthrough" type="radio" value="0">不启用
				</TD>
			</TR>		
			<TR>
								<TD width="100">&nbsp;&nbsp;L2TP 穿透：</TD>
								<TD>
									<input name="l2tp_passthrough" id="enable_l2tp_passthrough" type="radio" value="1">启用&nbsp;&nbsp;
									<input name="l2tp_passthrough" id="disable_l2tp_passthrough" type="radio" value="0">不启用
				</TD>	
			</TR>		
							<TR>
								<TD width="100">&nbsp;&nbsp;IPSec 穿透：</TD>
								<TD>
									<input name="ipsec_passthrough" id="enable_ipsec_passthrough" type="radio" value="1">启用&nbsp;&nbsp;
									<input name="ipsec_passthrough" id="disable_ipsec_passthrough" type="radio" value="0">不启用
	</TD>	
							</TR>					
						</table>
					</td></tr>
				</table>
	
				<table border="1" width="340" align="center" cellspacing="0" cellpadding="0" class="space">
					<tr><td width="310">
						<table border="0" width="300" align="center" cellspacing="0" cellpadding="2">
							<tr><td width="300" colspan="2">应用层网关 (ALG)</td></tr>
							<!--<tr><td colspan="2">&nbsp;</td></tr>-->
							<TR>
								<TD width="100">&nbsp;&nbsp;FTP ALG：</TD>
								<TD>
									<input name="ftp_alg" id="enable_ftp_alg" type="radio" value="1">启用&nbsp;&nbsp;
									<input name="ftp_alg" id="disable_ftp_alg" type="radio" value="0">不启用
								</TD>
							</TR>
	<TR>
								<TD width="100">&nbsp;&nbsp;TFTP ALG：</TD>
								<TD>
									<input name="tftp_alg" id="enable_tftp_alg" type="radio" value="1">启用&nbsp;&nbsp;
									<input name="tftp_alg" id="disable_tftp_alg" type="radio" value="0">不启用
								</TD>
							</TR>
							<TR>
								<TD width="100">&nbsp;&nbsp;H323 ALG：</TD>
								<TD>
									<input name="h323_alg" id="enable_h323_alg" type="radio" value="1">启用&nbsp;&nbsp;
									<input name="h323_alg" id="disable_h323_alg" type="radio" value="0">不启用
		</TD>
	</TR>	
						</table>
					</td></tr>
				</table>


			</td>
			<td class="vline" rowspan="15"><br></td>
		</tr>
		<tr><td class="hline"><img src="../images/empty.gif" width="1" height="1"></td></tr>
		<tr><td height="30" class="tail"> &nbsp; 			
			<input name="Save" type="button" class="button" id="Save" value="保 存" onClick="return doSave();">&nbsp;
			<input name="Help" type="button" class="button" value="帮 助" onClick="doHelp();">
	</TD></TR>
		<tr><td class="hline"><img src="../images/empty.gif" width="1" height="1"></td></tr>

	</table>
</td></tr>

</table>

</BODY>
<HEAD>
	<META http-equiv="pragma" content="no-cache">
</HEAD>
</HTML>
<SCRIPT language="JavaScript">
	document.getElementById("enable_spi").checked = spifw;
	document.getElementById("disable_spi").checked = !spifw;
	document.getElementById("enable_pptp_passthrough").checked = pptp;
	document.getElementById("disable_pptp_passthrough").checked = !pptp;
	document.getElementById("enable_l2tp_passthrough").checked = l2tp;
	document.getElementById("disable_l2tp_passthrough").checked = !l2tp;
	document.getElementById("enable_ipsec_passthrough").checked = ipsec;	
	document.getElementById("disable_ipsec_passthrough").checked = !ipsec;
	document.getElementById("enable_ftp_alg").checked = ftp;
	document.getElementById("disable_ftp_alg").checked = !ftp;
	document.getElementById("enable_tftp_alg").checked = tftp;
	document.getElementById("disable_tftp_alg").checked = !tftp;
	document.getElementById("enable_h323_alg").checked = h323;
	document.getElementById("disable_h323_alg").checked = !h323;
</SCRIPT>


