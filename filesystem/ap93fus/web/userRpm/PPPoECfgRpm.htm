
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<script language="JavaScript"><!-- 
var wanType = new Array(
"动态IP",	//	WAN_TYPE_DHCP = 0,
"静态IP",	//	WAN_TYPE_STATIC_IP, 
"PPPoE",	//	WAN_TYPE_PPPOE, 
"802.1x 动态IP",	//	WAN_TYPE_802_1X_DHCP,
"802.1x 静态IP",	//	WAN_TYPE_802_1X_STATIC_IP,
"BPA",	//	WAN_TYPE_BPA,
"L2TP",	//	WAN_TYPE_L2TP,
"PPTP",	//	WAN_TYPE_PPTP,
"DHCP+",	//WAN_TYPE_DHCP_PLUS,
""	//	WAN_TYPE_END
);
var PPPoELinkStat = new Array(
"未连接",
"已连接",
"正在连接..."
);
function doSubmit()
{
/*
	if(pppoeInf[4]==0)
	{
		if(!confirm("此功能需重启后才能生效，确定现在重启路由器？"))
		{
			 return false;
		}
	}
*/
	if(document.forms[0].linktype[0].checked)
	{
		if(!is_number(document.forms[0].waittime.value,0,99))
		{
			alert("时间输入错误，请重新输入(0-99)!");
			var element =document.forms[0].waittime;
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
	}
	if(document.forms[0].linktype[3].checked)
	{
		if(!is_number(document.forms[0].waittime2.value,0,99))
		{
			alert("时间输入错误，请重新输入(0-99)!");
			var element =document.forms[0].waittime2;
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
	}	
	if(document.forms[0].linktype[2].checked)
	{
		if(document.forms[0].hour1.value != "")
		{	
			if(!is_number(document.forms[0].hour1.value,0,24))
			{	
				alert("时间输入错误，请重新输入 (0-24)!");
				var element =document.forms[0].hour1;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		else 
		{
			if(document.forms[0].minute1.value != "" || document.forms[0].hour2.value != "" || document.forms[0].minute2.value != "")
			{
				alert("请输入时间!");
				var element =document.forms[0].hour1;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		if(document.forms[0].minute1.value != "")
		{	
			if(!is_number(document.forms[0].minute1.value,0,60))
			{	
				alert("时间输入错误，请重新输入(0-60)!");
				var element =document.forms[0].minute1;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		else 
		{
			if(document.forms[0].hour1.value != "" || document.forms[0].hour2.value != "" || document.forms[0].minute2.value != "")
			{
				alert("请输入时间!");
				var element =document.forms[0].minute1;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		if(document.forms[0].hour2.value != "")
		{
			if(!is_number(document.forms[0].hour2.value,0,24))
			{
				alert("时间输入错误，请重新输入 (0-24)!");
				var element =document.forms[0].hour2;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		else 
		{
			if(document.forms[0].minute2.value != "" || document.forms[0].hour1.value != "" || document.forms[0].minute1.value != "")
			{
				alert("请输入时间!");
				var element =document.forms[0].hour2;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		if(document.forms[0].minute2.value != "")
		{	
			if(!is_number(document.forms[0].minute2.value,0,60))
			{	
				alert("时间输入错误，请重新输入(0-60)!");
				var element =document.forms[0].minute2;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
		else 
		{
			if(document.forms[0].hour2.value != "" || document.forms[0].hour1.value != "" || document.forms[0].minute1.value != "")
			{
				alert("请输入时间!");
				var element =document.forms[0].minute2;
				if(element)
				{
					element.focus();
					element.select();
				}
				return false;
			}
		}
	}
	return true;
}
function doSelect()
{
	if(document.forms[0].linktype[0].checked)
	document.forms[0].waittime.disabled = false;
	else
	{
		document.forms[0].waittime.disabled = true;
	}
	if(document.forms[0].linktype[3].checked)
		document.forms[0].waittime2.disabled = false;
	else
	{
		document.forms[0].waittime2.disabled = true;
	}
	if(document.forms[0].linktype[2].checked)
	{
		document.forms[0].hour1.disabled = false;
		document.forms[0].minute1.disabled = false;
		document.forms[0].hour2.disabled = false;
		document.forms[0].minute2.disabled = false;
	}
	else
	{
		document.forms[0].hour1.disabled = true;
		document.forms[0].minute1.disabled = true;
		document.forms[0].hour2.disabled = true;
		document.forms[0].minute2.disabled = true;
	}
	return true;
}
function doAdvance()
{
	location.href="/userRpm/PPPoECfgAdvRpm.htm?Advanced=高级设置&wan="+pppoeInf[5];
}

var bRefreshFlag = 1;
function doFocus()
{
	bRefreshFlag = 0;
}
function doOnblur()
{
    bRefreshFlag = 1;
    //alert(bRefreshFlag);
}

function doLoad()
{
	if(document.forms[0].linktype[0].checked)
	document.forms[0].waittime.disabled = false;
	else
	{
		document.forms[0].waittime.disabled = true;
	}
	if(document.forms[0].linktype[3].checked)
	document.forms[0].waittime2.disabled = false;
	else
	{
		document.forms[0].waittime2.disabled = true;
	}
	if(document.forms[0].linktype[2].checked)
	{
		document.forms[0].hour1.disabled = false;
		document.forms[0].minute1.disabled = false;
		document.forms[0].hour2.disabled = false;
		document.forms[0].minute2.disabled = false;
	}
	else
	{
		document.forms[0].hour1.disabled = true;
		document.forms[0].minute1.disabled = true;
		document.forms[0].hour2.disabled = true;
		document.forms[0].minute2.disabled = true;
	}
	return true;
}
function doChange()
{
	if (pppoeInf[0]>1)
	{
		n = document.forms[0].wan.value;
	}else if(pppoeInf[0] = 1)
	{
		n = 0;
	}
	s = "wan="+n;
	var t = document.forms[0].wantype.selectedIndex;
	location.href = "/userRpm/"+wantypeinfo[t*2+2]+"?"+s;
}
function doWanChange()
{
	var n = document.forms[0].wan.selectedIndex;
	var s = "wan="+n;
	location.href = "/userRpm/WanCfgRpm.htm"+"?"+s;
}
function doHelp(){location.href="/help/PPPoECfgHelpRpm.htm";}
function doRefresh()
{
    if(bRefreshFlag == 1)
    {
        location.href="/userRpm/PPPoECfgRpm.htm";	
    }
}
function doDetect()
{
	location.href="/userRpm/PPPoECfgRpm.htm?detect=1";
}
function refresh()
{	
	location.href="/userRpm/PPPoECfgRpm.htm";	
}


function changeIpType()
{
	var IPtype;
	if(document.forms[0].SecType[1].checked==true) 
	{
		IPtype=1;
	}
	else if(document.forms[0].SecType[2].checked==true)
	{
		IPtype=2;
	}
	else
	{
		IPtype=0;
	}
    if(pppoeInf[0] > 1)
    {
        location.href = "PPPoECfgRpm.htm?SecType="+IPtype + "&wan=" +document.forms[0].wan.value;
    }
    else
    {
        location.href = "PPPoECfgRpm.htm?SecType="+IPtype + "&wan=0";
    }
}

function doRenew()
{
    if(pppoeInf[0] > 1)
    {
        location.href = "PPPoECfgRpm.htm?RenewIp=1" + "&wan=" +document.forms[0].wan.value;
    }
    else
    {
        location.href = "PPPoECfgRpm.htm?RenewIp=1" + "&wan=0";
    }	
}

function doRelease()
{
    if(pppoeInf[0] > 1)
    {
        location.href = "PPPoECfgRpm.htm?ReleaseIp=1" + "&wan=" +document.forms[0].wan.value;
    }
    else
    {
        location.href = "PPPoECfgRpm.htm?ReleaseIp=1" + "&wan=0";
    }	
}
//--></script></head>
<BODY>
<center><form action="PPPoECfgRpm.htm" enctype="multipart/form-data" method="get" onSubmit="return doSubmit();">
<table width="562" border="0" cellspacing="0" cellpadding="0">
<tr><td width="7" class="title"><IMG height=24 src="/images/arc.gif" width=7></td>
<td width="495" align="left" valign="center" class="title">WAN口设置</td>
</tr><tr><td colspan="2"><table width="562" border="0" cellspacing="0" cellpadding="0">

<tr><td class="vline" rowspan="15"><br></td>
<td width="560">
<table width="460" border="0" align="center" cellpadding="2" cellspacing="0" class="space">
<script language="JavaScript">
if(pppoeInf[0] > 1)
{
document.write('<TR><TD >WAN口：</TD><TD><select name="wan" class="list" id="wan" onChange="doWanChange()">');
for(var i=0;i<pppoeInf[0];i++)
{
	document.write('<option value=\"'+i+'\">WAN口'+(i+1)+'</option>');
}
document.write('</select></td></tr>');
}
else
{	
	document.write('<TR style ="display:none"><TD class=Item id = \"t_wan_port\">WAN Port:</TD><TD><select name=\"wan\" id=\"wan\" onChange=\"doWanChange()\">')
	document.write('<option value=0>WAN1</option>');
    document.write('</select>');
}
</script>
<TR><TD colspan=2></TD></TR>
<tr><td width="111">WAN口连接类型：</td>
<td width="285"><select name="wantype" class="list" onChange="doChange()" onFocus="doFocus()"  onblur = "doOnblur()">
<script language="JavaScript">
for ( var t=0; t < wantypeinfo[0]; t++)
{
	document.write('<option value="'+wantypeinfo[t*2+1]+'">'+wanType[wantypeinfo[t*2+1]]+'</option>');
}
</script>
</select>
&nbsp;
<input name="Discover" type="button" class="button" id="discover" value="自动检测" onClick=doDetect()>
<script language="JavaScript">
	var HAVE_NOT_DETECTED = 0;
	var DETECTIING = 1;
	var HAVE_DETECTED = 2;
	var DISCONNECTED = 3;
	 
	var detected_wan_type = wanTypeDetectInfoArray[0];
	var wan_type_detect_stat = wanTypeDetectInfoArray[1];
	var wait_time = wanTypeDetectInfoArray[2];
				
	switch (wan_type_detect_stat)
	{
	case HAVE_NOT_DETECTED:
		document.write('&nbsp;<font color="0000FF">' + '         ' + '</font>');
		break;
	case DETECTIING:
		document.write('&nbsp;<span style="color:#0000FF" id="t_det">正在检测...</span>');
		window.setTimeout("refresh()", wait_time);
		break;
	case HAVE_DETECTED:
		document.write('&nbsp;<font color="0000FF">' + wanType[detected_wan_type] + '</font>');
		break;
	case DISCONNECTED:
		document.write('&nbsp;<span style="color:#FF0000" id="t_unplugged">WAN口无连接</span>');
		break;
	default:
		break;
	}
</script>
</td>
</tr>
<TR><TD class=Item><b>PPPoE连接:</b></TD></TR>
<TR><TD width="150">上网账号：</TD><TD><input name="acc" class="text" value="" size="15" maxlength="118" ></TD></TR>
<TR><TD >上网口令：</TD><TD><input name="psw" type="password" class="text" value="" size="15" maxlength="118"></TD></TR>
<TR>
	<TD>特殊拨号：</TD>
	<TD><select name="specialDial" class="list" id="specialDial">
		<option value="0">无</option>
<script language="JavaScript">
for ( var t=1; t <=pppoeInf[28] ; t++)
{
	document.write('<option value=\"'+t+'\">特殊拨号模式'+t+'</option>');
}
</script>
</select></TD>
</TR>

<TR><TD colspan=2></TD></TR>
<TR><TD class=Item><b>第二连接：</b></TD>
</TD><TD><input name="SecType" type="radio" onClick="changeIpType()" value="0" CHECKED><span id = "t_sec_disable">禁用</span>&nbsp; &nbsp;
<input name="SecType" type="radio" onClick="changeIpType()" value="1"><span id = "t_sec_dynamic">动态 IP</span>&nbsp; &nbsp;
<input name="SecType" type="radio" onClick="changeIpType()" value="2"><span id = "t_sec_static">静态 IP</span></TD>
<TD>
</TR>
<script language="JavaScript">
if (pppoeInf[29]==1)
{
	document.write('<TR><TD class=Item id = "t_sec_ip_addr">IP 地址：</TD><TD>');
	document.write('<div id=ip>-</div></TD></TR>');
	document.write('<TR><TD class=Item id = "t_sub_mask">子网掩码：</TD><TD>');
	document.write('<div id=mask>-</div></TD></TR>');
	document.write('<TR style="display:none"><TD class=Item id = "t_sub_mask">数据包MTU（字节）：</TD><TD>');
	document.write('<input name="mtu" type="text" class="text" value="" size="5" maxlength="5"></TD></TR>');	
}
else if (pppoeInf[29]==2)
{
	document.write('<TR><TD class=Item id = "t_sec_ip_addr">IP 地址：</TD><TD>');
	document.write('<input name="ip" type="text" class="text" value="" size="15" maxlength="15"></TD></TR>');
	document.write('<TR><TD class=Item id = "t_sub_mask">子网掩码：</TD><TD>');
	document.write('<input name="mask" type="text" class="text" value="" size="15" maxlength="15"></TD></TR>');
	document.write('<TR style="display:none"><TD class=Item id = "t_sub_mask">数据包MTU（字节）：</TD><TD>');
	document.write('<input name="mtu" type="text" class="text" value="" size="5" maxlength="5"></TD></TR>');	
}

if (pppoeInf[29]==1)
{
	document.write('<TR><TD class=Item></TD>');
	document.write('<TD class=emp><input name="renewip" id="renewip" type="button" class="button" value="更新" onclick="doRenew();">&nbsp;&nbsp;');
	document.write('<input name="releaseip" id="releaseip" type="button" class="button" value="释放" onclick="doRelease();">&nbsp;&nbsp;');
	if(pppoeInf[33])
	{
		document.write("<span id = \"t_info\">正在获取网络参数...</span>");
	}
	else
	{
		document.write('&nbsp;');
	}
	document.write('</TD></TR>');
}
</script>
</table>
                <table width="460" border="0" align="center"  >
                  <TR>
                    <TD  colspan="2">根据您的需要，请选择对应的连接模式：</TD>
                  </tr>
<tr><TD><input name="linktype" type="radio" onClick="doSelect();" value="1"></td><td>按需连接，在有访问时自动连接</TD></TR>
<TR><TD></TD><TD>自动断线等待时间：<input name="waittime" class="text" value="" size="2" maxlength="2">&nbsp分&nbsp（0 表示不自动断线）</TD></TR>
<TR><TD ><input type="radio" name="linktype" value="2" onClick="doSelect();"></TD><TD>自动连接，在开机和断线后自动连接</TD></TR>
<TR><TD ><input type="radio" name="linktype" value="3" onClick="doSelect();"></TD><TD>定时连接，在指定的时间段自动连接</TD></TR>
<tr><td></td><td>注意：只有当您到“系统工具”菜单的“时间设置”项设置了当前时间后，“定时连接”功能才能生效。</td></tr>
<TR><TD></TD><TD>连接时段：从&nbsp<input name="hour1" type="text" class="text" value="" size="2" maxlength="2">
时&nbsp<input name="minute1" type="text" class="text" value="" size="2" maxlength="2">
分到&nbsp<input name="hour2" type="text" class="text" value="" size="2" maxlength="2">&nbsp时&nbsp<input name="minute2" type="text" class="text" value="" size="2" maxlength="2">&nbsp分</TD></TR>
<TR><TD ><input name="linktype" type="radio" onClick="doSelect();" value="4"></TD><TD>手动连接，由用户手动连接</TD></TR>
<TR><TD></TD><TD>自动断线等待时间：<input name="waittime2" class="text" value="" size="2" maxlength="2">&nbsp分&nbsp（0 表示不自动断线）</TD></TR>
<tr><td height="10" colspan="2"></td></tr>
<TR><TD></TD><TD><input name="Connect" type="submit" class="button" value="连 接"></input>&nbsp;&nbsp;
<input name="Disconnect" type="submit" class="button" value="断 线">&nbsp;&nbsp;
<span id="linkStat"></span>
</TD></TR>
<tr><td height="10" colspan="2"></td></tr>
<tr><td colspan="2"><input name="Advanced" type="button" class="button" value="高级设置" onclick="doAdvance();"></td></tr>
<tr><td height="10" colspan="2"></td></tr>
</table>
</td><td class="vline" rowspan="15"><br></td></tr>
<tr><td class="hline"><IMG height=1 src="/images/empty.gif" width=1></td></tr>
<tr><td height="30" class="tail">&nbsp;
<input name="Save" type="submit" class="button" value="保 存">&nbsp;
<input name="help" type="button" class="button" onClick="doHelp();" value="帮 助"></td>
</tr><tr><td class="hline"><IMG height=1 src="/images/empty.gif" width=1></td></tr>			
</table></td></tr></table>
</form></center></BODY><head><meta http-equiv="pragma" content="no-cache"></head></HTML>
<script language="JavaScript">
var tempB;
document.forms[0].wantype.selectedIndex = 2;
if(pppoeInf[0] != 1)
{
document.forms[0].wan.selectedIndex = pppoeInf[6];
}
document.forms[0].acc.value = pppoeInf[7];
document.forms[0].psw.value = pppoeInf[8];
tempB=(pppoeInf[20]==1)?true:false;
document.forms[0].linktype[0].checked = tempB;
tempB=(pppoeInf[20]==1)?false:true;
document.forms[0].waittime.value = pppoeInf[21];
document.forms[0].waittime.disabled = tempB;
tempB=(pppoeInf[20]==2)?true:false;
document.forms[0].linktype[1].checked = tempB;
tempB=(pppoeInf[20]==3)?true:false;
document.forms[0].linktype[2].checked = tempB;
tempB=(pppoeInf[20]==3)?false:true;
document.forms[0].hour1.value = pppoeInf[22];
document.forms[0].hour1.disabled = tempB;
document.forms[0].minute1.value = pppoeInf[23];
document.forms[0].minute1.disabled = tempB;
document.forms[0].hour2.value = pppoeInf[24];
document.forms[0].hour2.disabled = tempB;
document.forms[0].minute2.value = pppoeInf[25];
document.forms[0].minute2.disabled = tempB;
tempB=(pppoeInf[20]==4)?true:false;
document.forms[0].linktype[3].checked = tempB;
tempB=(pppoeInf[20]==4)?false:true;
document.forms[0].waittime2.value = pppoeInf[21];
document.forms[0].waittime2.disabled = tempB;
tempB=(pppoeInf[26])?true:false;
document.forms[0].Connect.disabled = tempB;
tempB=(pppoeInf[26])?false:true;
document.forms[0].Disconnect.disabled = tempB;
if (pppoeInf[29] == 1)
{
	document.forms[0].SecType[1].checked =true;
	document.getElementById("ip").innerHTML = pppoeInf[30];
	document.getElementById("mask").innerHTML = pppoeInf[31];
	if (pppoeInf[34] == 0)
		document.getElementById("renewip").disabled = true;
	if (pppoeInf[35] == 0)
		document.getElementById("releaseip").disabled = true;
	document.forms[0].mtu.value = pppoeInf[32];
}
else if(pppoeInf[29] == 2)
{
	document.forms[0].SecType[2].checked =true;
	document.forms[0].ip.value = pppoeInf[30];
	document.forms[0].mask.value = pppoeInf[31];
	document.forms[0].mtu.value = pppoeInf[32];
}
else
{
	document.forms[0].SecType[0].checked =true;
}
if (pppoeInf[26] == 2 || pppoeInf[35] != 0)
{   
    window.setTimeout("doRefresh()",20000);
}
document.getElementById("linkStat").innerHTML = PPPoELinkStat[pppoeInf[26]];
document.getElementById("specialDial").value = pppoeInf[27];
</script>